#!/bin/env node

var fs=require('fs');
var jours={},
	matchs=[];
jours["key"]=[] // cas ou le fichier est vide donc pas de jour dans l'objet
var file='./data/jours.json'

var init = (function() {
	fs.exists(file, function(exist) {
		if (exist) {
			var content = fs.readFileSync(file, 'utf8');
			content = JSON.parse(content);
			jours = content;
			if (typeof(jours["key"])=="undefined") {
				jours["key"]=[];
			}
			
		}
	});
	
exports.getMatchs=function () {
	return jours;
}

exports.getMatchsJour=function (day) {
	var res=[]
	if (typeof(jours[day])!="undefined") 
		res = jours[day];
	return res;
}

exports.addMatch =function(match) { // match de type { "jour":"J1","match":["local","visiteur"] }
	if (typeof(jours[match.jour])=="undefined") {
		jours[match.jour]=[];
		jours["key"].push(match.jour);
	}
	jours[match.jour].push(match.match);
	fs.writeFileSync(file,JSON.stringify(jours,null,4));
}

})();